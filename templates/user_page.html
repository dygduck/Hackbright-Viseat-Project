{% extends 'base.html' %}

{% block title %}Logged In{% endblock %}

{% block content %}
<h1>It is easy to Viseat!</h1>
<p>Hi {{ user.fname }}, would you like to make some trips?</p><br>
<div>
{% if trips_dict == {} %}
    <p>Hey, you haven't planned any trips yet!</p>
{% else %}
<form  id="user-all-trips" method="POST" action="/delete_places">
    <ul>
        {% for arrival_date, trip in trips_dict.iteritems()|sort %}
        <li><input class='trip-checkbox' type='checkbox' name='trip' value="{{ trip.trip_id }}">{{ arrival_date }} - {{ trip.departure_date }} - {{ trip.city_name }}
        <ul>
            {% for date, meals in trip.dates.iteritems()|sort %}
            <li><input class='date-checkbox' type='checkbox' name='date' value='{{trip.trip_id}}:{{date}}'>{{ date }}
                <ul>
                    {% if "breakfast" in meals %}
                        <li><input class='place-checkbox' type='checkbox' name='saved_place' value='{{ meals.breakfast.saved_place_id}}'>breakfast:<a href="{{ meals.breakfast.url }}"> {{ meals.breakfast.name }}</a></li>
                    {% endif %}
                    {% if "lunch" in meals %}
                        <li><input class='place-checkbox' type='checkbox' name='saved_place' value='{{ meals.lunch.saved_place_id}}'>lunch:<a href="{{ meals.lunch.url }}"> {{ meals.lunch.name }}</a></li>
                    {% endif %}
                    {% if "dinner" in meals %}
                        <li><input class='place-checkbox' type='checkbox' name='saved_place' value='{{ meals.dinner.saved_place_id}}'>dinner:<a href="{{ meals.dinner.url }}"> {{ meals.dinner.name }}</a></li>
                    {% endif %}
                </ul>
            </li>
            {% endfor %}
        </ul>
        {% endfor %}
    </li>
    </ul>
        <input type="submit" value="Delete">
</form>
{% endif %}
</div>

<form method="GET" action="/places">
    <div>
        <label>City</label>
        <select name="city_id" required>
            {% for city in cities %}
            <option value="{{city.city_id}}">{{city.city_name}}</option>
            {% endfor %}
        </select>
    </div>
    <div>
        <label>Arrival Date</label>
        <input type="datetime-local" name="arrival_date" required>
    </div>
    <div>
        <label>Departure Date</label>
        <input type="datetime-local" name="departure_date" required>
    </div>
    <input type="submit" value="Search!">
</form>
<form action="/logout" method="GET">
      <input type="submit" value="Logout">
</form>

<script src="../static/js/delete_places.js"></script>

{% endblock %}




